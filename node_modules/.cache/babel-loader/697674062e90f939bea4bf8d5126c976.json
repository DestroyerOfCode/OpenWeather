{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/prepelicamangalica/WorkspaceGit/SuperProjekt/src/main/ui/src/components/current/WeatherCurrent.js\";\nimport React, { Component } from 'react';\nimport WeatherCurrentService from '../../adapters/WeatherCurrentService';\nimport Pagination from '../current/Pagination';\nimport FiltersComponent from './Filters';\nimport { Link } from \"react-router-dom\";\nimport { getWeatherDescription, convertTemperature } from '../../businessLogic/WeatherBusinessLogic';\nimport { temperatureDropdownList } from '../../buildingBlocks/commonBuildingBlocks';\nimport '../../styles/common/Header.scss';\nimport '../../styles/current/Filters.scss';\nimport { nanoid } from \"nanoid\";\nimport { withTranslation } from 'react-i18next';\nimport i18n from 'i18next';\n\nclass WeatherCurrent extends Component {\n  constructor(props) {\n    super(props);\n\n    this.internationalizeDescriptions = descriptions => {\n      descriptions.map(description => {\n        console.log(\"description i18n: \" + i18n.t(`common.description.${description.name}`));\n        console.log(\"description: \" + description.name);\n        console.log(`common.description.${description.name}`);\n        return i18n.t(`common.description.${description.name}`);\n      });\n      descriptions.forEach(description => {\n        console.log(\"descrition: \" + description.name);\n      });\n      return descriptions;\n    };\n\n    this.addFilterOperatorToExistingFilterName = (event, filterName, filterOperator) => {\n      const arr = this.state.filters;\n      arr.forEach((item, index, filters) => {\n        if (item.hasOwnProperty([filterName])) {\n          filters[index][filterName][filterOperator] = event;\n        }\n      });\n      return arr;\n    };\n\n    this.onChangeFilter = (event, filterName, filterOperator) => {\n      // console.log(\"event: \" + JSON.stringify(event))\n      // console.log(\"filters: \" + JSON.stringify(this.state.filters))\n      var index;\n\n      if (event === \"\" && this.keyExistsInArr(this.state.filters, filterName)) {\n        console.log(\"inside 1\");\n        index = this.findIndexInFilters(this.state.filters, filterName);\n        this.setState({\n          currentPage: 1,\n          isFilter: true,\n          isAdditionalFilter: false,\n          filters: this.changeFilters(index, filterName, filterOperator)\n        }, function () {\n          this.refreshWeathers(this.state.sortBy, this.state.weathers);\n        });\n      } else if (event !== \"\" && !this.keyExistsInArr(this.state.filters, filterName)) {\n        console.log(\"inside 2\");\n        this.setState({\n          currentPage: 1,\n          isFilter: true,\n          isAdditionalFilter: true,\n          filters: this.state.filters.concat([{\n            [filterName]: {\n              [filterOperator]: event\n            }\n          }])\n        }, function () {\n          // console.log(\"filters inside: \" + this.state.filters)\n          this.refreshWeathers(this.state.sortBy, this.state.weathers);\n        });\n      } else if (event !== \"\" && this.keyExistsInArr(this.state.filters, filterName)) {\n        console.log(\"inside 3\");\n        index = this.findIndexInFilters(this.state.filters, filterName);\n        this.setState({\n          currentPage: 1,\n          isFilter: true,\n          isAdditionalFilter: this.isAdditionalFilterCheck(event, index, filterName, filterOperator),\n          filters: this.addFilterOperatorToExistingFilterName(event, filterName, filterOperator)\n        }, function () {\n          this.refreshWeathers(this.state.sortBy, this.state.weathers);\n        });\n      } else {\n        console.log(\"inside 4\");\n      }\n    };\n\n    this.createForecast = () => {\n      console.log(\"dfs\");\n      return /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/forecast\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 9\n      }, this);\n    };\n\n    this.paginate = page => {\n      // if(currentPage !== 0 && currentPage <= lastPage)\n      this.setState({\n        currentPage: page\n      }, function () {\n        console.log(\"currPage: \" + this.state.currentPage);\n      });\n    };\n\n    this.getWeathersOnSpecificPage = () => {\n      console.log('after pagination creation');\n      const indexOfLastPost = this.state.currentPage * this.state.itemsPerPage;\n      const indexOfFirstPost = indexOfLastPost - this.state.itemsPerPage;\n      return this.state.weathers.slice(indexOfFirstPost, indexOfLastPost);\n    };\n\n    this.changeLanguage = (language, i18n) => {\n      i18n.changeLanguage(language);\n    };\n\n    console.log(\"props.t: \" + props.t);\n    this.state = {\n      weathers: [],\n      isAscending: true,\n      filters: [],\n      isFilter: false,\n      currentPage: 1,\n      itemsPerPage: 1000,\n      loading: false,\n      isAdditionalFilter: false,\n      pageNumbers: [],\n      countries: [],\n      descriptions: [],\n      showPages: 5,\n      filterComponent: null,\n      languageButtons: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => this.changeLanguage(\"en\", i18n),\n          children: \"EN\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 33,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => this.changeLanguage(\"sk\", i18n),\n          children: \"SK\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 34,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => this.changeLanguage(\"de\", i18n),\n          children: \"DE\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 35,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 32,\n        columnNumber: 30\n      }, this),\n      temperatureDropdownList: temperatureDropdownList((units, abbreviation) => {\n        this.setState({\n          \"temperature\": {\n            \"units\": units,\n            \"abbreviation\": abbreviation\n          }\n        });\n      }),\n      temperature: {\n        units: 'celsius',\n        abbreviation: '°C'\n      }\n    };\n  } //I added temperatureDropdownList, filterscomponent and header here because I do not want to rerender them\n  //on every update. I cant use shouldComponentUpdate because they either are not components or are functional\n  //meaning they are stateless\n\n\n  async componentDidMount() {\n    console.log(\"som v componentDidMOunt weather list\");\n    const countries = await WeatherCurrentService.retrieveAllCountries();\n    const descriptions = await WeatherCurrentService.retrieveAllDescriptions();\n    this.setState({\n      countries: countries.data,\n      descriptions: this.internationalizeDescriptions(descriptions.data),\n      filterComponent: /*#__PURE__*/_jsxDEV(FiltersComponent, {\n        temperatureUnits: this.state.temperature.units,\n        countries: countries.data,\n        descriptions: this.internationalizeDescriptions(descriptions.data),\n        onChangeMethod: this.onChangeFilter\n      }, nanoid(), false, {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 30\n      }, this)\n    }, function () {\n      this.refreshWeathers();\n    });\n  }\n\n  async componentDidUpdate() {\n    console.log(\"som v componentDidMOunt weather list\");\n    const countries = await WeatherCurrentService.retrieveAllCountries();\n    const descriptions = await WeatherCurrentService.retrieveAllDescriptions();\n    this.setState({\n      countries: countries.data,\n      descriptions: this.internationalizeDescriptions(descriptions.data),\n      filterComponent: /*#__PURE__*/_jsxDEV(FiltersComponent, {\n        temperatureUnits: this.state.temperature.units,\n        countries: countries.data,\n        descriptions: this.internationalizeDescriptions(descriptions.data),\n        onChangeMethod: this.onChangeFilter\n      }, nanoid(), false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 30\n      }, this)\n    }, function () {\n      this.refreshWeathers();\n    });\n  }\n\n  refreshWeathers(sortBy, weathers) {\n    WeatherCurrentService.retrieveAllWeathers(sortBy, this.state.isAscending, this.state.filters, this.state.isFilter, this.state.isAdditionalFilter, weathers).then(response => {\n      this.setState({\n        weathers: response.data\n      });\n    }).then(() => {\n      if (sortBy) this.setState({\n        isAscending: !this.state.isAscending\n      });\n    }).then(() => {\n      if (typeof this.state.filters !== 'undefined' && this.state.filters === 0) this.setState({\n        isFilter: false\n      });\n    });\n  }\n\n  keyExistsInArr(arr, key) {\n    let exists = false;\n    console.log(\"arr inside keyExists: \" + JSON.stringify(arr));\n\n    if (!Array.isArray(key)) {\n      arr === null || arr === void 0 ? void 0 : arr.some(item => {\n        if (item.hasOwnProperty([key])) {\n          exists = true;\n          return true;\n        } else return false;\n      });\n    } //since countries and descriptions is a multicheckbox, they are arrays and it has multiple keys and must check not with equals\n    else {\n        arr === null || arr === void 0 ? void 0 : arr.some(item => {\n          if (item.includes([key])) {\n            exists = true;\n            return true;\n          } else return false;\n        });\n      }\n\n    return exists;\n  }\n\n  findIndexInFilters(arr, key) {\n    let indexOfKey = 0;\n    arr === null || arr === void 0 ? void 0 : arr.some((filterName, index, filters) => {\n      if (filterName.hasOwnProperty([key])) {\n        indexOfKey = index;\n        return indexOfKey;\n      } else return false;\n    });\n    return indexOfKey;\n  }\n\n  changeFilters(index, filterName, filterOperator) {\n    let arr = this.state.filters;\n    console.log(\"arr inside changefilters: \" + JSON.stringify(arr));\n    if (arr[index][filterName][filterOperator]) delete arr[index][filterName][filterOperator];\n    if (Object.keys(arr[index][filterName]).length === 0) arr.splice(index, 1);\n    return arr;\n  }\n\n  isAdditionalFilterCheck(event, index, filterName, filterOperator) {\n    if (this.isNotAdditionalFilterWithContains(event) === false) return false;\n    console.log(\"this.state.filters[index][filterName][filterOperator]: \" + this.state.filters[index][filterName][filterOperator]);\n    if (this.isSameFilterChanged(event, index, filterName, filterOperator) === false) return false;\n    return true;\n  } //if there are multiple countries and descriptions, backend must make a new query\n  //since no additional filter is added, only value. I am unable to send query request\n  //with an array element\n\n\n  isNotAdditionalFilterWithContains(event) {\n    return event.includes(\",\") ? false : true;\n  } // this check is here for times when I change the same filter multiple\n  // times in a row and the filter is same. If it is the same I cant filter\n  // from memory because I could not load some weathers\n\n\n  isSameFilterChanged(event, index, filterName, filterOperator) {\n    console.log(\"event: \" + event);\n    console.log(\"this.state.filters[index][filterName][filterOperator]: \" + this.state.filters[index][filterName][filterOperator]);\n    return filterName === this.state.filters[index][filterName];\n  }\n\n  header() {\n    return /*#__PURE__*/_jsxDEV(\"thead\", {\n      className: \"header\",\n      children: /*#__PURE__*/_jsxDEV(\"tr\", {\n        children: [/*#__PURE__*/_jsxDEV(\"th\", {\n          onClick: () => this.refreshWeathers(\"_id\", this.state.weathers),\n          children: i18n.t(\"current.header.cityId\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n          onClick: () => this.refreshWeathers(\"name\", this.state.weathers),\n          children: i18n.t('current.header.cityName')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n          onClick: () => this.refreshWeathers(\"coord.lat\", this.state.weathers),\n          children: i18n.t(\"current.header.latitude\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n          onClick: () => this.refreshWeathers(\"coord.lon\", this.state.weathers),\n          children: i18n.t(\"current.header.longitude\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n          onClick: () => this.refreshWeathers(\"sys.country\", this.state.weathers),\n          children: i18n.t(\"current.header.country\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n          onClick: () => this.refreshWeathers(\"weatherMain.humidity\", this.state.weathers),\n          children: i18n.t(\"current.header.humidity\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n          onClick: () => this.refreshWeathers(\"weatherMain.feels_like\", this.state.weathers),\n          children: i18n.t(\"current.header.feelsLike\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n          onClick: () => this.refreshWeathers(\"weatherMain.temp\", this.state.weathers),\n          children: i18n.t(\"current.header.temperature\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n          onClick: () => this.refreshWeathers(\"weatherMain.temp_max\", this.state.weathers),\n          children: i18n.t(\"current.header.maximumTemperature\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n          onClick: () => this.refreshWeathers(\"weatherMain.temp_min\", this.state.weathers),\n          children: i18n.t(\"current.header.minimalTemperature\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n          onClick: () => this.refreshWeathers(\"weather.description\", this.state.weathers),\n          children: i18n.t(\"current.header.description\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 12\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 8\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 16\n    }, this);\n  }\n\n  mainBody(currentPosts, temperature) {\n    return /*#__PURE__*/_jsxDEV(\"tbody\", {\n      children: currentPosts.map(weather => {\n        return /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n            children: weather._id\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: [\" \", /*#__PURE__*/_jsxDEV(Link, {\n              to: {\n                pathname: \"/forecast\",\n                state: {\n                  \"lat\": weather.coord.lat,\n                  \"lon\": weather.coord.lon\n                }\n              },\n              children: weather.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 255,\n              columnNumber: 30\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: weather.coord.lat\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: weather.coord.lon\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: weather.sys.country\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: weather.weatherMain.humidity\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: `${convertTemperature(temperature.units, weather.weatherMain.feels_like).toFixed(2)}${temperature.abbreviation}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: `${convertTemperature(temperature.units, weather.weatherMain.temp).toFixed(2)}${temperature.abbreviation}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 261,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: `${convertTemperature(temperature.units, weather.weatherMain.temp_max).toFixed(2)}${temperature.abbreviation}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: `${convertTemperature(temperature.units, weather.weatherMain.temp_min).toFixed(2)}${temperature.abbreviation}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: i18n.t(`common.description.${getWeatherDescription(weather)}`)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 25\n          }, this)]\n        }, nanoid(), true, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 29\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 5\n    }, this);\n  }\n\n  render() {\n    console.log(\"som v render weather list\");\n    const currentWeathers = this.getWeathersOnSpecificPage();\n    const filters = this.state.filterComponent;\n\n    const pagination = /*#__PURE__*/_jsxDEV(Pagination, {\n      currentPage: this.state.currentPage,\n      showPages: this.state.showPages,\n      itemsPerPage: this.state.itemsPerPage,\n      totalItems: this.state.weathers.length,\n      paginate: this.paginate\n    }, nanoid(), false, {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 28\n    }, this);\n\n    const temperatureDropdown = this.state.temperatureDropdownList;\n    const languageButtons = this.state.languageButtons;\n    let container = [languageButtons, temperatureDropdown, filters, pagination];\n    if (this.state.weathers) container.push( /*#__PURE__*/_jsxDEV(\"table\", {\n      className: \"weatherTable\",\n      children: [this.header(), this.mainBody(currentWeathers, this.state.temperature)]\n    }, nanoid(), true, {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 28\n    }, this));\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: container\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default withTranslation()(WeatherCurrent);","map":{"version":3,"sources":["/home/prepelicamangalica/WorkspaceGit/SuperProjekt/src/main/ui/src/components/current/WeatherCurrent.js"],"names":["React","Component","WeatherCurrentService","Pagination","FiltersComponent","Link","getWeatherDescription","convertTemperature","temperatureDropdownList","nanoid","withTranslation","i18n","WeatherCurrent","constructor","props","internationalizeDescriptions","descriptions","map","description","console","log","t","name","forEach","addFilterOperatorToExistingFilterName","event","filterName","filterOperator","arr","state","filters","item","index","hasOwnProperty","onChangeFilter","keyExistsInArr","findIndexInFilters","setState","currentPage","isFilter","isAdditionalFilter","changeFilters","refreshWeathers","sortBy","weathers","concat","isAdditionalFilterCheck","createForecast","paginate","page","getWeathersOnSpecificPage","indexOfLastPost","itemsPerPage","indexOfFirstPost","slice","changeLanguage","language","isAscending","loading","pageNumbers","countries","showPages","filterComponent","languageButtons","units","abbreviation","temperature","componentDidMount","retrieveAllCountries","retrieveAllDescriptions","data","componentDidUpdate","retrieveAllWeathers","then","response","key","exists","JSON","stringify","Array","isArray","some","includes","indexOfKey","Object","keys","length","splice","isNotAdditionalFilterWithContains","isSameFilterChanged","header","mainBody","currentPosts","weather","_id","pathname","coord","lat","lon","sys","country","weatherMain","humidity","feels_like","toFixed","temp","temp_max","temp_min","render","currentWeathers","pagination","temperatureDropdown","container","push"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport WeatherCurrentService from '../../adapters/WeatherCurrentService';\nimport Pagination from '../current/Pagination'\nimport FiltersComponent from './Filters'\nimport { Link } from \"react-router-dom\";\nimport {getWeatherDescription, convertTemperature} from '../../businessLogic/WeatherBusinessLogic';\nimport {temperatureDropdownList} from '../../buildingBlocks/commonBuildingBlocks'\nimport '../../styles/common/Header.scss';\nimport '../../styles/current/Filters.scss'\nimport { nanoid } from \"nanoid\";\nimport { withTranslation } from 'react-i18next';\nimport i18n from 'i18next'\n\nclass WeatherCurrent extends Component {\n    constructor(props) {\n        super(props)\n        console.log(\"props.t: \"+props.t)\n        this.state = {\n            weathers: [],\n            isAscending: true,\n            filters: [],\n            isFilter : false,\n            currentPage : 1,\n            itemsPerPage : 1000,\n            loading : false,\n            isAdditionalFilter : false,\n            pageNumbers : [],\n            countries : [],\n            descriptions: [],\n            showPages: 5,\n            filterComponent: null,\n            languageButtons: <div>                               \n                <button onClick={() => this.changeLanguage(\"en\", i18n)}>EN</button>\n                <button onClick={() => this.changeLanguage(\"sk\", i18n)}>SK</button>   \n                <button onClick={() => this.changeLanguage(\"de\", i18n)}>DE</button>   \n            </div>,\n            temperatureDropdownList: temperatureDropdownList( (units, abbreviation ) => {\n                this.setState({\"temperature\": {\"units\" : units, \"abbreviation\" : abbreviation}})\n            }),\n            temperature: {units: 'celsius', abbreviation: '°C'},            \n        }\n    }\n\n    //I added temperatureDropdownList, filterscomponent and header here because I do not want to rerender them\n    //on every update. I cant use shouldComponentUpdate because they either are not components or are functional\n    //meaning they are stateless\n    async componentDidMount() {\n        console.log(\"som v componentDidMOunt weather list\")\n        const countries = await WeatherCurrentService.retrieveAllCountries()\n        const descriptions = await WeatherCurrentService.retrieveAllDescriptions()\n        this.setState({countries : countries.data, descriptions : this.internationalizeDescriptions(descriptions.data), \n            filterComponent: <FiltersComponent key={nanoid()} temperatureUnits = {this.state.temperature.units} countries = {countries.data}\n            descriptions = {this.internationalizeDescriptions(descriptions.data)} onChangeMethod={this.onChangeFilter} />\n        },\n            function() {this.refreshWeathers()}\n        )\n        \n    }\n\n    async componentDidUpdate(){\n        console.log(\"som v componentDidMOunt weather list\")\n        const countries = await WeatherCurrentService.retrieveAllCountries()\n        const descriptions = await WeatherCurrentService.retrieveAllDescriptions()\n        this.setState({countries : countries.data, descriptions : this.internationalizeDescriptions(descriptions.data), \n            filterComponent: <FiltersComponent key={nanoid()} temperatureUnits = {this.state.temperature.units} countries = {countries.data}\n            descriptions = {this.internationalizeDescriptions(descriptions.data)} onChangeMethod={this.onChangeFilter} />\n        },\n            function() {this.refreshWeathers()}\n        )\n        }\n    internationalizeDescriptions = (descriptions) => {\n        descriptions.map(description => {\n            console.log(\"description i18n: \" + i18n.t(`common.description.${description.name}`))\n\n            console.log(\"description: \" + description.name)\n            console.log(`common.description.${description.name}`)\n            return i18n.t(`common.description.${description.name}`)\n        })\n        descriptions.forEach((description) =>{\n        console.log(\"descrition: \" + description.name)\n        })\n        return descriptions\n    }\n    refreshWeathers(sortBy, weathers) {\n\n        WeatherCurrentService.retrieveAllWeathers(sortBy, this.state.isAscending, this.state.filters, this.state.isFilter, this.state.isAdditionalFilter, weathers)\n            .then(\n                response => {\n                    this.setState({ weathers: response.data })\n                }\n            ).then( () => {if (sortBy) this.setState({isAscending : !this.state.isAscending})}\n            ).then( () => {if (typeof this.state.filters !== 'undefined' && this.state.filters === 0) this.setState({isFilter : false})})\n    }\n\n    keyExistsInArr(arr, key){\n        let exists = false\n        console.log(\"arr inside keyExists: \" + JSON.stringify(arr))\n        if (!Array.isArray(key)){\n            arr?.some(item => {\n                if(item.hasOwnProperty([key])) {\n                    exists = true;\n                    return true\n                }\n                else return false\n            })\n        }\n        //since countries and descriptions is a multicheckbox, they are arrays and it has multiple keys and must check not with equals\n        else{\n            arr?.some(item => {\n                if(item.includes([key])) {\n                    exists = true;\n                    return true\n                }\n                else return false\n            })\n        }\n        return exists\n    }\n\n    findIndexInFilters(arr, key){\n        let indexOfKey = 0\n        arr?.some((filterName, index, filters) => {\n            if(filterName.hasOwnProperty([key])){ \n                indexOfKey = index\n                return indexOfKey\n            }\n            else return false\n        })\n        return indexOfKey\n    }\n\n    changeFilters(index, filterName, filterOperator) {\n        let arr = this.state.filters\n        console.log(\"arr inside changefilters: \" + JSON.stringify(arr))\n\n        if (arr[index][filterName][filterOperator])\n            delete arr[index][filterName][filterOperator]  \n        if (Object.keys(arr[index][filterName]).length === 0)\n            arr.splice(index, 1)\n        return arr\n    }\n\n    addFilterOperatorToExistingFilterName = (event, filterName, filterOperator) => {\n        const arr = this.state.filters\n        arr.forEach((item, index, filters) => {\n            if (item.hasOwnProperty([filterName])){\n                filters[index][filterName][filterOperator] = event\n            }\n        })\n        return arr\n    }\n\n    onChangeFilter = (event, filterName, filterOperator) => {\n        // console.log(\"event: \" + JSON.stringify(event))\n        // console.log(\"filters: \" + JSON.stringify(this.state.filters))\n        var index;\n\n        if (event === \"\" && this.keyExistsInArr(this.state.filters,filterName))  {\n            console.log(\"inside 1\")\n\n            index = this.findIndexInFilters(this.state.filters, filterName)\n            this.setState({currentPage : 1, isFilter : true, isAdditionalFilter : false, filters : this.changeFilters(index, filterName, filterOperator)}, function () {\n                this.refreshWeathers(this.state.sortBy, this.state.weathers)\n            })\n        }\n\n        else if (event !== \"\" && !(this.keyExistsInArr(this.state.filters, filterName))){\n            console.log(\"inside 2\")\n\n            this.setState({currentPage : 1, isFilter : true, isAdditionalFilter : true,\n                 filters: this.state.filters.concat([{[filterName]: {[filterOperator] : event}}])}, function () {\n                // console.log(\"filters inside: \" + this.state.filters)\n                this.refreshWeathers(this.state.sortBy, this.state.weathers)\n            })\n\n        }\n\n        else if (event !== \"\" && (this.keyExistsInArr(this.state.filters, filterName))){\n           \n            console.log(\"inside 3\")\n            index = this.findIndexInFilters(this.state.filters, filterName)\n\n            \n            this.setState({currentPage : 1, isFilter : true, isAdditionalFilter : this.isAdditionalFilterCheck(event, index, filterName, filterOperator), \n                filters : this.addFilterOperatorToExistingFilterName(event, filterName, filterOperator)}, function() {\n                    this.refreshWeathers(this.state.sortBy, this.state.weathers)\n            })\n           \n        }\n        else {\n            console.log(\"inside 4\")\n\n        }\n    }\n\n    isAdditionalFilterCheck(event, index, filterName, filterOperator){\n        if (this.isNotAdditionalFilterWithContains(event) === false)\n            return false\n        console.log(\"this.state.filters[index][filterName][filterOperator]: \" + this.state.filters[index][filterName][filterOperator])\n        if (this.isSameFilterChanged(event, index, filterName, filterOperator) === false)\n            return false\n        return true\n                \n    }   \n\n    //if there are multiple countries and descriptions, backend must make a new query\n    //since no additional filter is added, only value. I am unable to send query request\n    //with an array element\n    isNotAdditionalFilterWithContains(event){\n       return event.includes(\",\") ? false : true\n    }\n    \n    // this check is here for times when I change the same filter multiple\n    // times in a row and the filter is same. If it is the same I cant filter\n    // from memory because I could not load some weathers\n    isSameFilterChanged(event, index, filterName, filterOperator){\n        console.log(\"event: \" + event)\n        console.log(\"this.state.filters[index][filterName][filterOperator]: \" + this.state.filters[index][filterName][filterOperator])\n       return filterName === this.state.filters[index][filterName]\n    }\n    header(){\n       return (<thead className=\"header\">\n       <tr>\n           <th onClick={() =>this.refreshWeathers(\"_id\", this.state.weathers) }>{i18n.t(\"current.header.cityId\")}</th>\n           <th onClick={() =>this.refreshWeathers(\"name\", this.state.weathers) }>{ i18n.t('current.header.cityName')}</th>\n           <th onClick={() =>this.refreshWeathers(\"coord.lat\", this.state.weathers) }>{i18n.t(\"current.header.latitude\")}</th>\n           <th onClick={() =>this.refreshWeathers(\"coord.lon\", this.state.weathers) }>{i18n.t(\"current.header.longitude\")}</th>\n           <th onClick={() =>this.refreshWeathers(\"sys.country\", this.state.weathers) }>{i18n.t(\"current.header.country\")}</th>\n           <th onClick={() =>this.refreshWeathers(\"weatherMain.humidity\", this.state.weathers) }>{i18n.t(\"current.header.humidity\")}</th>\n           <th onClick={() =>this.refreshWeathers(\"weatherMain.feels_like\", this.state.weathers) }>{i18n.t(\"current.header.feelsLike\")}</th>\n           <th onClick={() =>this.refreshWeathers(\"weatherMain.temp\", this.state.weathers) }>{i18n.t(\"current.header.temperature\")}</th>\n           <th onClick={() =>this.refreshWeathers(\"weatherMain.temp_max\", this.state.weathers) }>{i18n.t(\"current.header.maximumTemperature\")}</th>\n           <th onClick={() =>this.refreshWeathers(\"weatherMain.temp_min\", this.state.weathers) }>{i18n.t(\"current.header.minimalTemperature\")}</th>\n           <th onClick={() =>this.refreshWeathers(\"weather.description\", this.state.weathers) }>{i18n.t(\"current.header.description\")}</th>                                \n       </tr>\n   </thead>)\n   }\n\ncreateForecast = ()=>{\n    console.log(\"dfs\")\n    return (\n        <Link  to= '/forecast'></Link>\n    );\n}\n\n   mainBody(currentPosts, temperature){\n    return (\n\n    <tbody>\n        {\n            currentPosts.map(\n                weather =>{\n                    return (<tr key={nanoid()}>\n                        <td>{weather._id}</td>\n                        <td> <Link to={{pathname: \"/forecast\", state: {\"lat\": weather.coord.lat, \"lon\": weather.coord.lon} }}>{weather.name}</Link></td>\n                        <td>{weather.coord.lat}</td>\n                        <td>{weather.coord.lon}</td>\n                        <td>{weather.sys.country}</td>\n                        <td>{weather.weatherMain.humidity}</td>\n                        <td>{`${convertTemperature(temperature.units, weather.weatherMain.feels_like).toFixed(2)}${temperature.abbreviation}`}</td>\n                        <td>{`${convertTemperature(temperature.units, weather.weatherMain.temp).toFixed(2)}${temperature.abbreviation}`}</td>\n                        <td>{`${convertTemperature(temperature.units, weather.weatherMain.temp_max).toFixed(2)}${temperature.abbreviation}`}</td>\n                        <td>{`${convertTemperature(temperature.units, weather.weatherMain.temp_min).toFixed(2)}${temperature.abbreviation}`}</td>\n                        <td>{i18n.t(`common.description.${getWeatherDescription(weather)}`)}</td>\n                    </tr>)}\n            )\n        }\n        </tbody>\n    )\n   }\n\n    paginate = (page) => {\n        // if(currentPage !== 0 && currentPage <= lastPage)\n       this.setState({currentPage : page}, function(){\n           console.log(\"currPage: \" + this.state.currentPage)\n       })\n\n    }\n\n    getWeathersOnSpecificPage = () => {\n        console.log('after pagination creation')\n        const indexOfLastPost = this.state.currentPage * this.state.itemsPerPage;\n        const indexOfFirstPost = indexOfLastPost - this.state.itemsPerPage;\n        return this.state.weathers.slice(indexOfFirstPost, indexOfLastPost);\n    }\n    changeLanguage = (language, i18n) => {\n        i18n.changeLanguage(language);\n    };\n    render() {\n        console.log(\"som v render weather list\")\n\n        const currentWeathers = this.getWeathersOnSpecificPage()\n        const filters = this.state.filterComponent\n\n        const pagination = <Pagination key={nanoid()} currentPage={this.state.currentPage} showPages={this.state.showPages}\n        itemsPerPage = {this.state.itemsPerPage} totalItems = {this.state.weathers.length} paginate={this.paginate}/>\n\n        const temperatureDropdown = this.state.temperatureDropdownList\n        const languageButtons = this.state.languageButtons\n\n        let container= [languageButtons, temperatureDropdown, filters, pagination]\n\n        if (this.state.weathers)\n            container.push(<table key={nanoid()} className=\"weatherTable\">\n                {this.header()}\n                {this.mainBody(currentWeathers, this.state.temperature)}\n            </table>\n            )\n\n        return (\n            <div className=\"container\">\n\n                {container}\n            </div>\n        )\n         \n    }\n}\nexport default withTranslation()(WeatherCurrent)\n"]},"metadata":{},"sourceType":"module"}